# Title

Complexity-aware Adaptive Training and Inference for Edge-Cloud Distributed AI Systems

## Website
https://doi.org/10.1109/ICDCS51616.2021.00061

## Citing

@INPROCEEDINGS{9546405,
author={Long, Yinghan and Chakraborty, Indranil and Srinivasan, Gopalakrishnan and Roy, Kaushik},
booktitle={2021 IEEE 41st International Conference on Distributed Computing Systems (ICDCS)},
title={Complexity-aware Adaptive Training and Inference for Edge-Cloud Distributed AI Systems},
year={2021},
pages={573-583}

## Brief Introduction

该论文提出了一种可应用于边缘计算的复杂度感知的云边自适应分布式训练 / 推理 AI 系统，在考虑到边缘设备性能限制的前提下，根据输入实例的复杂度进行分类，将复杂输入实例上传至云计算中心，其余输入实例在边缘设备完成计算处理。经验证，该系统能在降低训练成本的同时提高模型的准确度。

## Key Methodology

1. MEANet

   输入实例的分类器，把输入实例分为简单、困难（预测准确率低）、复杂（实例的信息熵大）三类。由主模块、自适应模块与拓展模块三部分组成。

   - 主模块

     包括了边缘神经网络的卷积层部分的主体。由于参数量大，因此由云端进行训练并发放到边缘。该模块对实例进行所属标签的预测。

   - 自适应模块

     主模块的轻量化，与主模块每个多层全连接层对应的部分都只有一层卷积层，减少了拓展模块输入对主模块输出的依赖，拓展模块可以根据自适应模块提供的权重来矫正主模块的判定边界。

   - 拓展模块

     增加网络的深度，在主模块的分类基础上，对实例进行更精确的简单 / 困难分类。

2. 训练过程

   云端训练深度卷积网络作为云端的 AI，并使用全局数据训练边缘 AI 的主模块网络。之后用主模块跑验证集，将结果根据准确率升序排序，取前若干个定义为“困难“类实例，并分别建立困难类 / 简单类与标签的映射（此处的标签是新建了一个字典，和之前的不一样），将模型与映射分发到边。在边缘，使用固定的主模块与本地的困难实例（减小训练数据量），训练自适应模块与拓展模块。

3. 推理过程

   主模块预测输入实例的标签，然后使用 softmax 进行分类，根据云服务器下发的映射判断其是否属于困难类以及具体对应的标签，并输入拓展模块和自适应模块中。最后，通过比较 softmax score 的大小，取主模块与拓展模块中可信度更高的输出作为最终结果。

 4. 云边协同的分布式推理

    根据预测熵所体现的实例复杂度以及分类的可信度，来决定是否将实例上传至云上进行处理。正确预测的预测熵呈以0为极值的指数分布，而错误预测的预测熵则呈均值大于1的正态分布，因此熵大于阈值，则将实例的原始数据上传到云端。


## Data sets & Experimental Design

实验数据：CIFAR-100 / ImageNet with ResNet & MobileNetV2

实验结果：

1. 训练集与测试集显示，自适应模块与拓展模块相对于主模块，能提高对困难类的预测准确率。
2. 对简单 / 困难类的预测准确率约为90%。
3. 对于拓展模块与自适应模块的训练数据，只使用困难类实例进行训练，且样本量在增大后效果变差。
4. 对于不同的困难度阈值，当阈值低至某个值（即发往云端的数据占比大于某个值），整体模型的预测准确率不再提高。
5. 与上一个实验结合，测试了不同困难度阈值下的边缘设备能耗，云边结合可以在保持准确率不变的前提下降低约40%的能耗。


## Conclusion And Future Work

该论文提出了一种根据困难度对输入实例进行分类分层处理的分布式 AI 系统。文中采用的是多分类模型，但是二分类模型似乎也可行，文中对二分类模型情况的叙述很少，并且没有给出相关的实验对比。
